# M1阶段完整测试计划

> 确保M1阶段框架搭建100%完成后再进入M2阶段

## 🎯 测试目标

验证M1阶段所有功能模块的稳定性和正确性，确保：
- UI界面完整可用
- 菜单功能正常
- 串口基础功能正确
- 状态同步准确
- 异常处理健壮

---

## 📋 测试清单

### ✅ 已完成测试

1. **基础依赖测试** - `test_m1_framework.py`
   - [x] PyQt5、pyserial、openpyxl导入正常
   - [x] 核心模块导入正常
   - [x] Excel模板读取正常

2. **对话框功能测试** - `test_dialogs.py`
   - [x] 串口配置对话框创建正常
   - [x] 标准值输入对话框创建正常

3. **状态同步测试** - 手动验证
   - [x] 串口配置与状态栏显示一致
   - [x] 防错设计：未配置时的提示

---

## 🔄 待完成测试

### 1. UI界面完整性测试 📱

**测试目标**: 验证所有UI组件正确显示和基础交互

**测试内容**:
- [ ] **主窗口布局**
  - [ ] 窗口正常启动，最小尺寸合理(1000x700)
  - [ ] 左右分割布局正确显示
  - [ ] 工具栏、菜单栏、状态栏正常显示

- [ ] **5个校表步骤控件**
  - [ ] 每个步骤的复选框、按钮、标签正确显示
  - [ ] 复选框可正常勾选/取消
  - [ ] "执行此步"按钮可点击
  - [ ] 结果显示区域布局正确

- [ ] **通信日志区域**
  - [ ] 文本区域正常显示
  - [ ] 自动滚动功能
  - [ ] 字体为等宽字体
  - [ ] 支持文本选择和复制

- [ ] **工具栏控件**
  - [ ] "一键校表"按钮可点击
  - [ ] "开始串口"/"关闭串口"按钮切换正常
  - [ ] "刷新端口"按钮可点击
  - [ ] 状态指示灯颜色切换(绿/灰/黄/红)

- [ ] **状态栏显示**
  - [ ] 串口状态显示区域
  - [ ] 标准值状态显示区域
  - [ ] 文本自动截断处理

### 2. 菜单系统完整性测试 📋

**测试目标**: 验证所有菜单项可正常打开且功能正确

**测试内容**:
- [ ] **文件菜单**
  - [ ] "载入模板" - 点击有日志输出
  - [ ] "导出记录" - 点击有日志输出
  - [ ] "退出" - 正常关闭程序

- [ ] **通讯菜单**
  - [ ] "串口配置" - 打开配置对话框
  - [ ] "端口探测" - 显示可用端口列表

- [ ] **参数菜单**
  - [ ] "标准值输入" - 打开标准值对话框
  - [ ] "工程师参数" - 有日志输出

- [ ] **自动化菜单**
  - [ ] "步骤模板管理" - 有日志输出
  - [ ] "执行策略" - 有日志输出

- [ ] **帮助菜单**
  - [ ] "使用说明" - 有日志输出
  - [ ] "关于" - 显示关于对话框

### 3. 串口配置对话框测试 ⚙️

**测试目标**: 验证串口配置功能完整正确

**测试内容**:
- [ ] **界面显示**
  - [ ] 对话框正常打开，标题正确
  - [ ] 所有控件正确显示和布局
  - [ ] 端口下拉框显示系统可用端口

- [ ] **参数设置**
  - [ ] 端口选择：可选择不同端口
  - [ ] 波特率：2400/4800/9600等选项，可编辑
  - [ ] 数据位：7/8选项
  - [ ] 校验位：None/Even/Odd选项
  - [ ] 停止位：1/2选项
  - [ ] 超时设置：读超时/写超时数值可调
  - [ ] 重试设置：重试次数/帧间隔可调

- [ ] **刷新端口功能**
  - [ ] 点击"刷新"按钮更新端口列表
  - [ ] 刷新后保持当前选择(如果端口仍存在)

- [ ] **配置保存**
  - [ ] 点击"确定"保存配置
  - [ ] 主窗口状态栏显示更新
  - [ ] 点击"取消"不保存配置

- [ ] **配置恢复**
  - [ ] 再次打开对话框，显示上次配置的值

### 4. 标准值输入对话框测试 📊

**测试目标**: 验证标准值设置功能和数据验证

**测试内容**:
- [ ] **界面显示**
  - [ ] 对话框正常打开，标题正确
  - [ ] 标准电压/电流输入框正确显示
  - [ ] 误差校准模式区域正确显示

- [ ] **数值输入与验证**
  - [ ] 标准电压：90-300V范围，超出时红色提示
  - [ ] 标准电流：0-200A范围，超出时红色提示
  - [ ] 功率误差：±10%范围，超出时红色提示
  - [ ] 范围外数值时"确定"按钮禁用

- [ ] **误差校准模式**
  - [ ] 复选框切换正常
  - [ ] 启用时功率误差输入框可用
  - [ ] 禁用时功率误差输入框禁用且归零

- [ ] **配置保存**
  - [ ] 点击"确定"保存配置
  - [ ] 主窗口状态栏显示更新
  - [ ] 点击"取消"不保存配置

- [ ] **配置恢复**
  - [ ] 再次打开对话框，显示上次配置的值

### 5. 串口功能集成测试 📡

**测试目标**: 验证串口开关和状态管理逻辑

**测试内容**:
- [ ] **未配置状态**
  - [ ] 初始状态：按钮显示"开始串口"
  - [ ] 状态栏显示"串口: 未连接"
  - [ ] 状态灯为灰色
  - [ ] 点击"开始串口"提示"请先配置串口参数"

- [ ] **配置后状态**
  - [ ] 配置串口后状态栏显示"{配置} (未连接)"
  - [ ] 状态灯仍为灰色
  - [ ] 按钮仍显示"开始串口"

- [ ] **开启串口状态(模拟)**
  - [ ] 点击"开始串口"后
    - [ ] 按钮文字变为"关闭串口"
    - [ ] 状态栏显示"{配置}"(无"未连接")
    - [ ] 状态灯变为绿色
    - [ ] 日志显示开启信息

- [ ] **关闭串口状态**
  - [ ] 点击"关闭串口"后
    - [ ] 按钮文字变为"开始串口"
    - [ ] 状态栏显示"串口: 未连接"
    - [ ] 状态灯变为灰色
    - [ ] 日志显示关闭信息

### 6. 端口探测功能测试 🔍

**测试目标**: 验证端口枚举功能

**测试内容**:
- [ ] **基础功能**
  - [ ] 点击"端口探测"菜单项
  - [ ] 日志显示找到的端口列表
  - [ ] 无端口时显示"未发现可用串口"

- [ ] **刷新端口功能**
  - [ ] 点击工具栏"刷新端口"按钮
  - [ ] 日志显示刷新操作

### 7. 校表步骤模拟测试 🔄

**测试目标**: 验证校表步骤UI交互逻辑

**测试内容**:
- [ ] **单步执行**
  - [ ] 点击任一步骤的"执行此步"按钮
  - [ ] 步骤状态变为"正在执行..."(蓝色图标)
  - [ ] 2秒后随机显示成功(✓绿色)或失败(✗红色)
  - [ ] 显示执行时间和结果信息

- [ ] **一键校表**
  - [ ] 勾选多个步骤
  - [ ] 点击"一键校表"按钮
  - [ ] 日志显示选中的步骤列表
  - [ ] 未勾选任何步骤时提示"未选择任何步骤"

### 8. 日志系统测试 📝

**测试目标**: 验证日志记录和显示功能

**测试内容**:
- [ ] **日志格式**
  - [ ] 每条日志包含时间戳[HH:MM:SS.sss]
  - [ ] 消息内容正确显示
  - [ ] 自动滚动到最新日志

- [ ] **日志内容**
  - [ ] 程序启动时显示启动信息
  - [ ] 菜单点击时显示相应日志
  - [ ] 配置保存时显示配置信息
  - [ ] 串口操作时显示状态变化

### 9. 异常处理测试 🛡️

**测试目标**: 验证程序健壮性

**测试内容**:
- [ ] **快速连续操作**
  - [ ] 快速点击多个菜单项不报错
  - [ ] 快速打开/关闭对话框不报错

- [ ] **边界值测试**
  - [ ] 标准值对话框输入边界值
  - [ ] 串口配置输入最大/最小值

- [ ] **窗口操作**
  - [ ] 最小化/恢复窗口正常
  - [ ] 调整窗口大小布局自适应
  - [ ] 关闭程序正常退出

### 10. 性能测试 ⚡

**测试目标**: 验证程序性能表现

**测试内容**:
- [ ] **启动性能**
  - [ ] 程序启动时间 < 3秒
  - [ ] 内存占用 < 100MB

- [ ] **响应性能**
  - [ ] 菜单点击响应 < 200ms
  - [ ] 对话框打开 < 500ms
  - [ ] UI操作流畅无卡顿

---

## 🧪 测试执行方式

### 自动化测试
- 运行 `test_m1_framework.py` - 基础功能测试
- 运行 `test_dialogs.py` - 对话框创建测试

### 手动测试
- 按照上述清单逐项验证
- 记录发现的问题和异常情况
- 验证修复后的功能

### 测试完成标准
- [ ] 所有测试项目通过
- [ ] 无阻塞性Bug
- [ ] 性能指标达标
- [ ] 用户体验流畅

---

## 📊 测试报告模板

```
M1阶段测试报告 - {日期}

✅ 通过项目: {数量}
❌ 失败项目: {数量}
⚠️  警告项目: {数量}

发现问题:
1. 问题描述
2. 复现步骤
3. 期望结果
4. 实际结果

修复建议:
1. 具体修复方案
2. 优先级评估

整体评估: [优秀/良好/需改进]
```

---

**测试完成后，M1阶段正式结束，可进入M2阶段开发！**